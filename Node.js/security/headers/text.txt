const express = require('express');
const cors = require('cors');

const app = express();

// Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÑ‹ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ñ Ð´Ð¾Ð²ÐµÑ€ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð´Ð¾Ð¼ÐµÐ½Ð°
const corsOptions = {
  origin: 'https://trusted-frontend.com', 
  credentials: true // Ð Ð°Ð·Ñ€ÐµÑˆÐ°ÐµÐ¼ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ñƒ cookies
};

app.use(cors(corsOptions));

app.get('/api/data', (req, res) => {
  res.json({ message: 'Ð”Ð°Ð½Ð½Ñ‹Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¿Ð¾Ð»ÑƒÑ‡ÐµÐ½Ñ‹!' });
});

const PORT = 3000;
app.listen(PORT, () => {
  console.log(`ðŸ”’ Ð¡ÐµÑ€Ð²ÐµÑ€ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ñ CORS-Ð·Ð°Ñ‰Ð¸Ñ‚Ð¾Ð¹ Ð½Ð° http://localhost:${PORT}`);
});
///////
app.use((req, res, next) => {
  res.setHeader(
    'Strict-Transport-Security',
    'max-age=31536000; includeSubDomains; preload'
  );
  next();
});
///////
app.use((req, res, next) => {
  res.setHeader('X-Frame-Options', 'DENY'); // Ð¸Ð»Ð¸ SAMEORIGIN
  res.setHeader('Content-Security-Policy', "frame-ancestors 'self'");
  next();
});